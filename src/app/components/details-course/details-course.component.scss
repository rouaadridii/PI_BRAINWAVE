// Variables
$primary-color: #007bff;
$secondary-color: #6c757d;
$success-color: #28a745;   // Vert pour Disponible, Validé & Score
$danger-color: #dc3545;    // Rouge pour Indisponible & action Invalider
$warning-color: #ffc107;   // Jaune/Orangé pour étoiles & bouton Consulter
$light-gray: #f8f9fa;
$medium-light-gray: #e9ecef; // Gris pour fond inactif score & bouton
$dark-gray: #343a40;      // Gris foncé pour texte & icône non validée
$font-family: 'Arial', sans-serif;
$empty-star-color: #adb5bd; // Couleur pour les étoiles vides

// Réinitialisation globale (Basique)
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: $font-family; }

// --- Styles Conteneur Principal ---
.course-detail-container {
    background-image: url('/assets/templatefront/assets/images/meetings-bg.jpg');
    background-size: cover; background-position: center; background-attachment: fixed;
    padding: 4rem 1rem; display: flex; justify-content: center;
    align-items: flex-start; min-height: 100vh;

    .course-card-wrapper {
        width: 100%; max-width: 1200px; padding: 0;

        .course-card {
            background-color: rgba(255, 255, 255, 0.98); border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); padding: 0;
            width: 100%; display: flex; flex-direction: column; overflow: hidden;
        }
    }
}

// --- Styles Image + Titre Overlay ---
.course-image-container {
    text-align: center;
    position: relative;
    overflow: hidden;
    min-height: 150px; // Hauteur minimale même si l'image ne charge pas
    background-color: $medium-light-gray; // Fond visible si l'image est absente

    .course-image {
        display: block; width: 100%; height: auto;
        max-height: 400px; object-fit: cover;
    }
    .image-title-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.75) 10%, rgba(0, 0, 0, 0) 80%);
      padding: 2rem 1.5rem 1.5rem 1.5rem; box-sizing: border-box;
      .overlay-course-title {
        color: #ffffff; font-size: 2.5rem; font-weight: bold; margin: 0;
        line-height: 1.2; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        @media (max-width: 768px) { font-size: 1.8rem; padding: 1.5rem 1rem 1rem 1rem; }
      }
    }
}

// --- Styles Contenu Info ---
.course-info {
    padding: 2rem;
    .course-description-container {
      margin-bottom: 1.5rem;
      .course-description {
          font-size: 1rem; color: $secondary-color; line-height: 1.6; text-align: left; margin: 0;
          .detail-label { font-weight: bold; color: $dark-gray; margin-right: 0.5rem; }
      }
    }
}

// --- Styles Grille Détails ---
.course-details-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem; margin-bottom: 2rem; padding: 0 2rem;

    .course-details-item {
        display: flex; align-items: center; padding: 0.8rem 1rem; border-radius: 8px;
        background-color: $light-gray; box-shadow: 0 1px 3px rgba(0,0,0,0.05); overflow: hidden;

        .detail-icon { margin-right: 0.8rem; color: $primary-color; font-size: 1.3rem; flex-shrink: 0; }
        .detail-label { font-weight: bold; margin-right: 0.5rem; color: $dark-gray; flex-shrink: 0; }
        span:not(.detail-label), span.status-text, div:not(.progress-circle) {
            color: $secondary-color; word-break: break-word; line-height: 1.4;
        }
        .status-text { font-weight: bold;
            &.status-available { color: $success-color; }
            &.status-unavailable { color: $danger-color; }
        }

        // Styles Progress Circle (avec conic-gradient)
        .progress-circle {
          position: relative; width: 45px; height: 45px; border-radius: 50%;
          display: grid; place-items: center; margin-left: auto;
          background: $medium-light-gray;
          @property --progress-percent { syntax: '<number>'; inherits: false; initial-value: 0; }
          transition: --progress-percent 0.3s ease-out;
          background: conic-gradient( $success-color 0% calc(var(--progress-percent, 0) * 1%), $medium-light-gray calc(var(--progress-percent, 0) * 1%) 100% );
          &::before { content: ""; position: absolute; width: calc(100% - 8px); height: calc(100% - 8px); background: $light-gray; border-radius: 50%; }
          .progress-value { position: relative; z-index: 1; font-size: 0.75rem; font-weight: bold; color: $dark-gray; }
        } // Fin .progress-circle

    } // Fin .course-details-item
} // Fin .course-details-grid


// --- Sections Attachments & Avis ---
.attachments-section, .reviews-section, .add-review-section {
    margin-top: 2.5rem; padding: 0 2rem;
    .section-title {
        font-size: 1.6rem; font-weight: bold; margin-bottom: 1.5rem; color: $dark-gray;
        border-bottom: 2px solid $primary-color; padding-bottom: 0.5rem;
        display: inline-flex; align-items: center; gap: 0.6rem;
        i.lucide { font-size: 1.4rem; color: $primary-color;}
    }
}

// --- Styles Table Attachments ---
.attachments-table {
    width: 100%; border-collapse: collapse; margin-bottom: 1rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05); border-radius: 8px; overflow: hidden;
    th, td { padding: 1rem; text-align: left; border-bottom: 1px solid $medium-light-gray; vertical-align: middle; }
    th { background-color: $primary-color; color: white; font-weight: 600; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; }
    tr { transition: background-color 0.2s ease; &:hover { background-color: $light-gray; } &:last-child td { border-bottom: none; } }

    // Styles pour les boutons (Télécharger, Consulter, Fermer)
    .download-button, .view-button, .close-button {
        padding: 0.5rem 1rem; border: none; border-radius: 20px; cursor: pointer;
        transition: all 0.2s ease; font-weight: 500; letter-spacing: 0.3px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); display: inline-flex; align-items: center;
        gap: 0.4rem; font-size: 0.85rem;
        i.lucide { font-size: 1rem; }
        &:hover { transform: translateY(-2px); box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15); }
        &:focus { outline: none; box-shadow: 0 0 0 3px rgba($primary-color, 0.4); }
    }
    .download-button { background-color: $primary-color; color: white; text-decoration: none; &:hover { background-color: darken($primary-color, 10%); } }
    .view-button { background-color: $warning-color; color: $dark-gray; &:hover { background-color: darken($warning-color, 10%); } }
    .close-button { background-color: $danger-color; color: white; &:hover { background-color: darken($danger-color, 10%); } }

    // Styles pour le bouton toggle de validation (avec fonds pour visibilité)
    td.validation-cell { text-align: center; }
    td .validation-toggle-button {
        border: 1px solid transparent; padding: 0.3rem; margin: 0; cursor: pointer; border-radius: 50%;
        display: inline-flex; align-items: center; justify-content: center;
        transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        width: 36px; height: 36px; opacity: 1 !important;
        i.lucide { font-size: 1.6rem; line-height: 1; }
        // État non validé
        &.not-validated {
            background-color: $medium-light-gray; border-color: darken($medium-light-gray, 10%);
            color: $dark-gray; // Icône gris foncé (visible)
            &:hover { background-color: rgba($success-color, 0.2); border-color: rgba($success-color, 0.4); color: $success-color; }
        }
        // État validé
        &.validated {
            background-color: rgba($success-color, 0.15); border-color: rgba($success-color, 0.3);
            color: $success-color; // Icône verte
            &:hover { background-color: rgba($danger-color, 0.15); border-color: rgba($danger-color, 0.3); color: $danger-color; }
        }
        // Style de focus
        &:focus { outline: none; box-shadow: 0 0 0 3px rgba($primary-color, 0.4); }
    }
    // Fin styles bouton toggle

} // Fin .attachments-table

// --- Toast Message ---
.toast-container {
     position: fixed; top: 1rem; right: 1rem; z-index: 1050;
     .toast-message { background-color: $success-color; color: white; padding: 1rem 1.5rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); font-size: 1rem; }
}

.no-attachments-text, .no-reviews-text { color: $secondary-color; font-style: italic; padding: 1rem 0; }

// --- PDF Preview ---
.pdf-preview {
    margin-top: 1.5rem; border: 1px solid #dee2e6; border-radius: 8px;
    overflow: hidden; position: relative;
    .close-pdf-preview-button {
      position: absolute; top: 8px; right: 8px; background-color: rgba(0, 0, 0, 0.6);
      color: white; border: none; border-radius: 50%; width: 32px; height: 32px;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      z-index: 10; transition: background-color 0.2s ease;
      i.lucide { font-size: 1.1rem; line-height: 1; }
      &:hover { background-color: $danger-color; }
    }
    iframe { display: block; width: 100%; height: 600px; border: none; }
}

// --- Section Avis ---
.reviews-section {
    .average-rating {
        font-size: 1.1rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; color: $dark-gray;
        i.icon-average-rating { color: $warning-color; font-size: 1.3rem;}
        .star-rating-display {
            display: inline-flex; gap: 1px;
            i.fa { font-size: 1.1rem; line-height: 1; }
            .fa-star { color: $warning-color; }
            .fa-star-o { color: $empty-star-color; }
            .fa-star-half-o {
                position: relative; color: $empty-star-color;
                &::after { content: '\f089'; position: absolute; top: 0; left: 0; width: 50%; overflow: hidden; color: $warning-color; }
            }
        }
    }

    .reviews-list {
        max-height: 400px; overflow-y: auto; border: 1px solid #e9ecef;
        border-radius: 8px; padding: 0.5rem; margin-top: 1rem;
        .review-card {
            background-color: #fff; border: 1px solid #e9ecef; border-radius: 8px;
            padding: 1rem 1.5rem; margin: 0.5rem; box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
            position: relative;
            p { margin-bottom: 0.5rem; line-height: 1.5; }
            strong { color: $dark-gray; }
            .star-rating {
                i.fa { color: $warning-color; font-size: 1rem; margin-right: 1px; }
                .fa-star-o { color: $empty-star-color; }
            }
            .delete-review-button {
                position: absolute; top: 0.5rem; right: 0.5rem; padding: 0.3rem 0.5rem;
                background-color: transparent; color: $danger-color; border: none;
                border-radius: 50%; cursor: pointer; transition: all 0.2s ease; opacity: 0.6;
                 i.lucide { font-size: 1.1rem; }
                &:hover { background-color: $danger-color; color: white; opacity: 1; }
            }
        }
    }
}

// --- Section Ajouter Avis ---
.add-review-section {
    .review-form {
        background-color: $light-gray; padding: 1.5rem; border-radius: 8px; margin-top: 1rem;
        .form-group {
            margin-bottom: 1.5rem;
            .form-label { display: block; margin-bottom: 0.6rem; font-weight: 600; color: $dark-gray; font-size: 0.9rem; }
            .rating {
                display: flex; align-items: center; gap: 3px;
                i.rating-star {
                    cursor: pointer; font-size: 1.5rem; transition: transform 0.1s ease-in-out, color 0.2s ease;
                    &.fa-star { color: $warning-color; }
                    &.fa-star-o { color: $empty-star-color; }
                    &.hovered, &:hover { transform: scale(1.2); color: $warning-color !important; }
                }
            }
            .form-control {
                width: 100%; padding: 0.8rem 1rem; font-size: 1rem; border: 1px solid #ced4da;
                border-radius: 5px; transition: border-color 0.2s ease, box-shadow 0.2s ease; line-height: 1.5;
                &:focus { border-color: $primary-color; outline: none; box-shadow: 0 0 0 3px rgba($primary-color, 0.25); }
            }
        }
        .submit-review-button {
            padding: 0.8rem 1.5rem; background-color: $success-color; color: white; border: none;
            border-radius: 25px; cursor: pointer; transition: all 0.2s ease; font-weight: 600;
            font-size: 1rem; display: inline-flex; align-items: center; gap: 0.5rem;
            i.lucide { font-size: 1.1rem; }
            &:hover { background-color: darken($success-color, 10%); transform: translateY(-2px); box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
            &:disabled { background-color: $secondary-color; opacity: 0.65; cursor: not-allowed; transform: none; box-shadow: none;}
        }
    }
}

// --- Bouton Retour ---
.back-button-container {
    text-align: center; margin-top: 3rem; padding: 2rem 0; border-top: 1px solid #e9ecef;
    .back-button {
        padding: 0.8rem 2rem; background-color: $secondary-color; color: white; border: none;
        border-radius: 25px; cursor: pointer; transition: all 0.2s ease; text-decoration: none;
        font-weight: 600; font-size: 1rem; display: inline-flex; align-items: center; gap: 0.6rem;
         i.lucide { font-size: 1.1rem; }
        &:hover { background-color: darken($secondary-color, 10%); transform: translateY(-2px); box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
    }
}

// --- Indicateur de chargement ---
.loading-indicator { text-align: center; padding: 4rem; font-size: 1.2rem; color: $secondary-color; font-style: italic; }

// --- Styles spécifiques pour les petits écrans ---
@media (max-width: 768px) {
    .course-detail-container { padding: 2rem 0.5rem; }
    .course-info, .attachments-section, .reviews-section, .add-review-section { padding: 1.5rem; }
    .course-details-grid { grid-template-columns: 1fr; padding: 0 1.5rem; gap: 1rem; }
    .attachments-table {
        td.validation-cell { text-align: center; }
        td .validation-toggle-button { width: 34px; height: 34px; i.lucide { font-size: 1.4rem; } }
        // Styles existants pour le défilement horizontal
        display: block; overflow-x: auto; white-space: nowrap; th, td { padding: 0.8rem; } th { font-size: 0.8rem; }
         .download-button, .view-button, .close-button { padding: 0.4rem 0.8rem; font-size: 0.8rem; i.lucide { font-size: 0.9rem; } }
    }
    .pdf-preview iframe { height: 450px; }
    .back-button-container { margin-top: 2rem; padding: 1.5rem 0;}
    .back-button { padding: 0.7rem 1.5rem; font-size: 0.9rem;}
    // Ajuster titre overlay sur mobile
     .course-image-container .image-title-overlay .overlay-course-title { font-size: 1.8rem; padding: 1.5rem 1rem 1rem 1rem; }
}