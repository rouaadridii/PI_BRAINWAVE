<body>
  <app-front-header></app-front-header>
  <div class="course-details container">
      <div class="course-banner">
          <img [src]="course.picture ? 'http://localhost:8087/cours/courses/images/' + course.picture : 'assets/default-image.jpg'"
               alt="{{ course.title }}">
          <div class="overlay">
              <h1>{{ course.title }}</h1>
              <p>{{ course.description }}</p>
          </div>
      </div>

      <div class="row mt-4">
          <div class="col-md-8">
              <div class="course-info p-4 shadow-sm">
                  <h3>√Ä propos de ce cours</h3>
                  <p><strong>Description :</strong> {{ course.description }}</p>
                  <p><strong>Date :</strong> {{ course.date | date: 'longDate' }}</p>
                  <p><strong>Niveau :</strong> {{ course.level }}</p>
                  <p><strong>Status :</strong>
                      <span [ngClass]="{'badge bg-success': course.status, 'badge bg-danger': !course.status}">
                          {{ course.status ? 'Disponible' : 'Indisponible' }}
                      </span>
                  </p>
              </div>

              <div class="attachments mt-4 p-4 shadow-sm">
                  <h3>Ressources du cours</h3>
                  <div *ngIf="attachments.length > 0; else noAttachments">
                      <ul class="list-group">
                          <li *ngFor="let attachment of attachments"
                              class="list-group-item d-flex justify-content-between align-items-center">
                              <div>
                                  <h5>{{ attachment.chapterTitle }}</h5>
                                  <span class="badge bg-info">{{ attachment.type }}</span>
                              </div>
                              <div>
                                  <a [href]="'http://localhost:8087/cours/attachments/attachment/' + attachment.idAttachment"
                                     class="btn btn-sm btn-primary me-2" target="_blank">üìÇ Telecharger</a>
                                  <button class="btn btn-sm btn-warning" (click)="openEditForm(attachment)">‚úèÔ∏è
                                      Modifier</button>
                                  <button class="btn btn-sm btn-danger ms-2"
                                          (click)="deleteAttachment(attachment.idAttachment)">üóëÔ∏è Supprimer</button>
                              </div>
                          </li>
                      </ul>
                  </div>
                  <ng-template #noAttachments>
                      <p class="text-muted">Aucune ressource ajout√©e.</p>
                  </ng-template>
              </div>

              <div *ngIf="isEditing && editingAttachment" class="edit-attachment-form mt-4 p-4 shadow-sm">
                  <h4>Modifier l'Attachment</h4>
                  <form (ngSubmit)="updateAttachment()">
                      <div class="mb-3">
                          <label for="editChapterTitle" class="form-label">Titre du chapitre</label>
                          <input type="text" [(ngModel)]="editingAttachment.chapterTitle" class="form-control"
                                 id="editChapterTitle" name="editChapterTitle" required>
                      </div>
                      <div class="mb-3">
                          <label for="editVisibility" class="form-label">Visibilit√©</label>
                          <select [(ngModel)]="editingAttachment.visible" class="form-control" id="editVisibility"
                                  name="editVisibility">
                              <option [value]="true">Visible</option>
                              <option [value]="false">Masqu√©</option>
                          </select>
                      </div>
                      <div class="mb-3">
                          <label for="editFile" class="form-label">Fichier</label>
                          <input type="file" class="form-control" id="editFile" (change)="onEditFileSelected($event)">
                      </div>
                      <button type="submit" class="btn btn-primary me-2">Enregistrer</button>
                      <button type="button" class="btn btn-secondary" (click)="cancelEdit()">Annuler</button>
                  </form>
              </div>

              <div class="reviews mt-4 p-4 shadow-sm">
                  <h3>Ce que disent les √©tudiants</h3>
                  <div *ngIf="reviews.length > 0; else noReviews">
                      <div class="reviews-list">
                          <ul class="list-unstyled">
                              <li *ngFor="let review of reviews" class="review-item mb-3">
                                  <div class="d-flex align-items-center">
                                      <span class="star-rating me-2">
                                          <i *ngFor="let star of [1,2,3,4,5]" class="fa fa-star"
                                             [ngClass]="{'text-warning': review.rating >= star, 'text-muted': review.rating < star}"></i>
                                      </span>
                                      <p class="mb-0">{{ review.comment }}</p>
                                  </div>
                              </li>
                          </ul>
                      </div>
                  </div>
                  <ng-template #noReviews>
                      <p class="text-muted">Aucune √©valuation pour l‚Äôinstant.</p>
                  </ng-template>
              </div>
          </div>

          <div class="col-md-4">
              <div class="course-sidebar p-4 shadow-sm">
                  <h3 class="text-center">{{ course.price | currency }}</h3>
                  <button class="btn btn-primary w-100 mt-3">S'inscrire</button>
              </div>

              <div class="add-attachment mt-4 p-4 shadow-sm">
                  <h4>Ajouter un Attachment</h4>
                  <input type="text" [(ngModel)]="chapterTitle" class="form-control my-2"
                         placeholder="Titre du chapitre">
                  <input type="file" class="form-control my-2" (change)="onFileSelected($event)">
                  <button class="btn btn-success w-100" (click)="addAttachment()">‚ûï Ajouter</button>
              </div>
          </div>
      </div>
  </div>
  <app-front-footer></app-front-footer>
</body>